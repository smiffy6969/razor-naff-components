<!--
* razor-naff-components
* @author Paul Smith (smiffy6969)
* @site ulsmith.net
* @licence MIT
--><html><head><script>
    naff.registerElement({
        name: 'naff-icon',

		created: function()
		{
			// Initial setup
            if (this.host.className.indexOf('fa') >= 0) return;
            this.addClasses();
		},

		attributeChanged: function(name, oldVal, newVal)
		{
            if (name == 'class') return; // altered class directly
            this.addClasses();
		},

        addClasses: function()
        {
            var className = ' fa';
            var classes = this.host.className.split(' ');
            for (var i = 0; i < classes.length; i++) className += classes[i] == 'fa' || classes[i].trim().indexOf('fa-') == 0 ? '' : ' ' + classes[i];

            if (this.host.hasAttribute('name')) className += ' fa-' + this.host.getAttribute('name');
            if (this.host.hasAttribute('size')) className += ' fa-' + this.host.getAttribute('size') + 'x';
            if (this.host.hasAttribute('rotate')) className += ' fa-rotate-' + this.host.getAttribute('rotate');
            if (this.host.hasAttribute('stack')) className += ' fa-stack-' + this.host.getAttribute('stack') + 'x';
            if (this.host.hasAttribute('fw')) className += ' fa-fw';
            if (this.host.hasAttribute('spin')) className += ' fa-spin';
            if (this.host.hasAttribute('pulse')) className += ' fa-pulse';
            if (this.host.hasAttribute('inverse')) className += ' fa-inverse';
            if (this.host.hasAttribute('border')) className += ' fa-border';
            this.host.className = className.trim();
        }
    })
</script>

<style type="text/css">
	naff-tag { display: inline-block; padding: 6px 8px; background: #ddd; color: #222;}
	naff-tag[size='extra-small'] { padding: 2px 4px; font-size: 10px; line-height: 10px; }
	naff-tag[size='small'] { padding: 4px 6px; font-size: 12px; line-height: 12px; }
	naff-tag[size='medium'] { padding: 6px 8px; font-size: 14px; line-height: 16px; }
	naff-tag[size='large'] { padding: 8px 12px; font-size: 18px; line-height: 18px; }
	naff-tag[size='extra-large'] { padding: 10px 14px; font-size: 22px; line-height: 22px; }
	naff-tag[shape='round'] { border-radius: 100px; }
	naff-tag[shape='rounded'] { border-radius: 5px; }
	naff-tag[shape='oval'] { border-radius: 75% / 77%; }
	naff-tag[color='grey'] { background: #ddd; color: #222; }
	naff-tag[color='blue'] { background: rgb(74, 74, 255); color: #fff; }
	naff-tag[color='red'] { background: rgb(255, 44, 44); color: #fff; }
	naff-tag[color='green'] { background: rgb(18, 163, 18); color: #fff; }
	naff-tag[color='orange'] { background: rgb(255, 136, 26); color: #fff; }
	naff-tag[color='black'] { background: #222; color: #fff; }
	naff-tag[color='pink'] { background: #D729D5; color: #fff; }
	naff-tag[color='purple'] { background: #8913D4; color: #fff; }
	naff-tag[color='yellow'] { background: #E5E522; color: #444; }
	naff-tag[color='aqua'] { background: #31AEDB; color: #FFF; }
	naff-tag[color='white'] { background: #FFFFFF; color: #444; }
</style>

<!-- LOGIC -->
<script>naff.registerElement({name: 'naff-tag'})</script>


<!-- STYLE - Encapsulate all css to tag name -->
<style>
	naff-input .-input-group input { padding: 2px 5px; border: none; border-bottom: 2px solid #888; outline: none; font-size: 15px; background: transparent; }
	naff-input .-input-group input:focus:not([disabled]), naff-input .-input-group input:active:not([disabled]) { border-bottom-width: 2px; border-color: #444; }
	naff-input .-input-group input[disabled] { cursor: not-allowed; border-bottom: 2px dashed #888; background-color: #fff; }
	naff-input .-input-group input.error, naff-input .-input-group input.error:focus, naff-input .-input-group input.error:active { border-color: red; color: red; }
	naff-input .-input-group .-input-error { visibility: hidden; color: red; font-size: 11px; line-height: 10px; }
	naff-input .-input-group .-input-error naff-icon, naff-input .-input-group .-input-error .-input-error-message { color: red; font-size: 11px; line-height: 10px}
</style>

<!-- TEMPLATE -->
<template id="naff-input">
	<div class="-input-group">
		<input>
		<div class="-input-error">
			<naff-icon name="warning"></naff-icon>
			<span class="-input-error-message"></span>
		</div>
	</div>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-input',

		// public properties
		value: null,
		error: null,

		// private properties
		private: {
			validate: null,
			validateMessage: 'Fails validation',
			match: null,
			matchMessage: 'Does not match'
		},

		created: function()
		{
			// Initial setup
			if (this.host.hasAttribute('name')) this.template.querySelector('input').setAttribute('name', this.host.getAttribute('name'));
			if (this.host.hasAttribute('type')) this.template.querySelector('input').setAttribute('type', this.host.getAttribute('type'));
			if (this.host.value || this.host.hasAttribute('value')) this.value = this.template.querySelector('input').value = this.host.value || this.host.getAttribute('value');
			if (this.host.hasAttribute('disabled')) this.template.querySelector('input').setAttribute('disabled', '');
			if (this.host.hasAttribute('placeholder')) this.template.querySelector('input').setAttribute('placeholder', this.host.getAttribute('placeholder'));
			if (this.host.hasAttribute('required')) this.template.querySelector('input').setAttribute('required', '');
			if (this.host.hasAttribute('validate')) this.private.validate = this.host.getAttribute('validate');
			if (this.host.hasAttribute('validate-message')) this.private.validateMessage = this.host.getAttribute('validate-message');
			if (this.host.hasAttribute('match')) this.private.match = this.host.getAttribute('match');
			if (this.host.hasAttribute('match-message')) this.private.matchMessage = this.host.getAttribute('match-message');

			// force check on start if error set
			if (this.host.hasAttribute('error')) this.checkError(this.value);
		},

		attached: function()
		{
			this.template.querySelector('input').addEventListener('input', this.onInputChanged);
			this.template.querySelector('input').addEventListener('keypress', this.onKeyPressed);
		},

		detached: function()
		{
			this.template.querySelector('input').removeEventListener('input', this.onInputChanged);
			this.template.querySelector('input').removeEventListener('keypress', this.onKeyPressed);
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			switch (name)
			{
				case 'name':
				case 'type':
				case 'placeholder':
					if (newVal) this.template.querySelector('input').setAttribute(name, newVal);
					else this.template.querySelector('input').removeAttribute(name);
				break;
				case 'value':
					this.host.value = this.value = newVal;
					this.template.querySelector('input').value = newVal;
				break;
				case 'disabled':
					if (this.host.hasAttribute(name)) this.template.querySelector('input').setAttribute(name, '');
					else this.template.querySelector('input').removeAttribute(name);
				break;
				case 'validate':
				case 'match':
				case 'match-message':
					this.private[name] = newVal;
				break;
				case 'validate-message':
					this.private.validateMessage = newVal;
					this.template.querySelector('.-input-error-message').innerText = newVal;
				break;
			}
		},

		onInputChanged: function()
		{
			var scope = naff.getScope(this);
			scope.checkError(this.value);
			scope.host.value = scope.value = this.value; // have to push changes to host value too for data binders
			scope.host.setAttribute('value', this.value);
			scope.fire('changed');
		},

		onKeyPressed: function(event)
		{
			naff.getScope(this).fire('keypress', event);
		},

		checkError: function(value)
		{
			if (!this.private.validate) return;

			// validate input
			var regexp = new RegExp(this.private.validate);
			this.error = !regexp.test(value);

			if (this.error)
			{
				this.template.querySelector('.-input-error-message').innerHTML = this.private.validateMessage;
				this.template.querySelector('.-input-error').style.visibility = 'visible';
				this.host.setAttribute('error', 1);
				this.fire('error', this.private.validateMessage);
			}
			else if (this.private.match != null && this.private.match != value)
			{
				this.error = true;
				this.template.querySelector('.-input-error-message').innerHTML = this.private.matchMessage;
				this.template.querySelector('.-input-error').style.visibility = 'visible';
				this.host.setAttribute('error', 1);
				this.fire('error', this.private.matchMessage);
			}
			else
			{
				this.template.querySelector('.-input-error').style.visibility = 'hidden';
				this.host.setAttribute('error', 0);
				this.fire('ok');
			}
		},

		focus: function()
		{
			return this.template.querySelector('input').focus();
		}
	});
</script>



<!-- STYLE - Encapsulate all css to tag name -->
<style>
	naff-switch[disabled] naff-icon { opacity: 0.5; cursor: not-allowed; }
	naff-switch naff-icon.fa-toggle-on, naff-switch naff-icon.fa-toggle-off { font-size: 30px; line-height: 30px; cursor: pointer; }
	naff-switch naff-icon[name='toggle-on'] { color: green; }
</style>

<!-- TEMPLATE -->
<template id="naff-switch">
	<naff-icon></naff-icon>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-switch',

		// Public properties
		toggle: 0,
		disabled: false,

		created: function()
		{
			// Initial setup
			if (this.host.hasAttribute('disabled')) this.disabled = true;
			if (this.host.hasAttribute('toggle')) this.toggle = this.host.getAttribute('toggle');
			else this.host.setAttribute('toggle', this.toggle);
			this.setSwitch();
		},

		attached: function()
		{
			this.template.querySelector('naff-icon').addEventListener('click', this.click);
		},

		detached: function()
		{
			this.template.querySelector('naff-icon').removeEventListener('click', this.click);
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			if (name == 'disabled') this.disabled = !newValue ? false: true;
			if (name =='toggle')
			{
				this.toggle = newVal == 1 ? 1 : 0;
				this.setSwitch();
			}
		},

		click: function()
		{
			var scope = this.parentNode.scope;
			if (scope.disabled) return;
			scope.host.setAttribute('toggle', scope.toggle == 1 ? 0 : 1);
		},

		setSwitch: function()
		{
			this.template.querySelector('naff-icon').setAttribute('name', 'toggle-' + (this.toggle == 1 ? 'on' : 'off'));
			this.fire('change');
		}
	});
</script>

<style type="text/css">
	button[is='naff-x-button'] { opacity: 0.9; border: 1px solid #bbb; background: #ddd; color: #222; cursor: pointer; }
	button[is='naff-x-button']:focus { opacity: 1; outline: none; }
	button[is='naff-x-button']:active:not(.disabled) { opacity: 0.8; }
	button[is='naff-x-button'][disabled], button[is='naff-x-button'][disabled]:hover, button[is='naff-x-button'][disabled]:focus { opacity: 0.4; cursor: not-allowed; }
	button[is='naff-x-button'][size='extra-small'] { padding: 4px 4px; font-size: 10px; line-height: 10px; }
	button[is='naff-x-button'][size='small'] { padding: 5px 8px; font-size: 12px; line-height: 13px; }
	button[is='naff-x-button'][size='medium'] { padding: 7px 8px; font-size: 14px; line-height: 14px; }
	button[is='naff-x-button'][size='large'] { padding: 8px 12px; font-size: 17px; line-height: 17px; }
	button[is='naff-x-button'][size='extra-large'] { padding: 9px 14px; font-size: 20px; line-height: 20px; }
	button[is='naff-x-button'][shape='round'] { -webkit-border-radius: 100px; -moz-border-radius: 100px; -ms-border-radius: 100px; -o-border-radius: 100px; border-radius: 100px; }
	button[is='naff-x-button'][shape='rounded'] { -webkit-border-radius: 5px; -moz-border-radius: 5px; -ms-border-radius: 5px; -o-border-radius: 5px; border-radius: 5px; }
	button[is='naff-x-button'][shape='oval'] { -webkit-border-radius: 75% / 77%; -moz-border-radius: 75% / 77%; -ms-border-radius: 75% / 77%; -o-border-radius: 75% / 77%; border-radius: 75% / 77%; }
	button[is='naff-x-button'][color='grey'] { border: 1px solid #bbb; background: #ddd; color: #222; }
	button[is='naff-x-button'][color='blue'] { border: 1px solid blue; background: rgb(74, 74, 255); color: #fff; }
	button[is='naff-x-button'][color='red'] { border: 1px solid red; background: rgb(255, 44, 44); color: #fff; }
	button[is='naff-x-button'][color='green'] { border: 1px solid green; background: rgb(18, 163, 18); color: #fff; }
	button[is='naff-x-button'][color='orange'] { border: 1px solid rgb(255, 118, 26); background: rgb(255, 136, 26); color: #fff; }
	button[is='naff-x-button'][color='black'] { border: 1px solid #111; background: #222; color: #fff; }
	button[is='naff-x-button'][color='pink'] { border: 1px solid #991C97; background: #D729D5; color: #fff; }
	button[is='naff-x-button'][color='purple'] { border: 1px solid #440869; background: #8913D4; color: #fff; }
	button[is='naff-x-button'][color='yellow'] { border: 1px solid #CCCC36; background: #E5E522; color: #444; }
	button[is='naff-x-button'][color='aqua'] { border: 1px solid #308FB1; background: #31AEDB; color: #FFF; }
	button[is='naff-x-button'][color='white'] { border: 1px solid #ccc; background: #FFFFFF; color: #444; }
</style>

<!-- LOGIC -->
<script>naff.registerElement({name: 'naff-x-button', extends: 'button'})</script>

<script>
	// build scope
	naff.registerElement({
		name: 'naff-x-form',
		extends: 'form',
		error: false,

		private: {
			matches: []
		},

		created: function()
		{
			this.private.matches = this.host.querySelectorAll('naff-input, select[is=naff-x-select], textarea[is=naff-x-textarea]');
		},

		attached: function()
		{
			for (var i = 0; i < this.private.matches.length; i++) this.private.matches[i].addEventListener('changed', this.checkError);
		},

		detached: function()
		{
			for (var i = 0; i < this.private.matches.length; i++) this.private.matches[i].removeEventListener('changed', this.checkError);
		},

		checkError: function(event, scope)
		{
			var scope = scope || naff.getParentScope(this, 'naff-x-form');
			var error = false;
			for (var i = 0; i < scope.private.matches.length; i++)
			{
				if (scope.private.matches[i].hasAttribute('disabled')) continue;
				if ((scope.private.matches[i].hasAttribute('required') && !scope.private.matches[i].scope.value) || (scope.private.matches[i].scope && scope.private.matches[i].scope.error)) error = true;
			}
			scope.error = error;

			if (!!error)
			{
				scope.host.setAttribute('error', 1);
				scope.fire('error');
			}
			else
			{
				scope.host.setAttribute('error', 0);
				scope.fire('ok');
			}
		}
	});
</script>



<!-- STYLE - Encapsulate all css to tag name -->
<style type="text/css">
	button[is='naff-x-icon-button'] { opacity: 0.9; border: 1px solid #bbb; background: #ddd; color: #222; cursor: pointer; }
	button[is='naff-x-icon-button']:focus { opacity: 1; outline: none;}
	button[is='naff-x-icon-button']:active:not(.disabled) { opacity: 0.8; }
	button[is='naff-x-icon-button'][disabled], button[is='naff-x-icon-button'][disabled]:hover, button[is='naff-x-icon-button'][disabled]:focus { opacity: 0.4; cursor: not-allowed; }
	button[is='naff-x-icon-button'][size='extra-small'] { width: 20px; height: 20px; font-size: 9px; }
	button[is='naff-x-icon-button'][size='small'] { width: 25px; height: 25px; font-size: 12px; }
	button[is='naff-x-icon-button'][size='medium'] { width: 30px; height: 30px; font-size: 14px; }
	button[is='naff-x-icon-button'][size='large'] { width: 35px; height: 35px; font-size: 18px; }
	button[is='naff-x-icon-button'][size='extra-large'] { width: 40px; height: 40px; font-size: 22px; }
	button[is='naff-x-icon-button'][shape='round'] { -webkit-border-radius: 100px; -moz-border-radius: 100px; -ms-border-radius: 100px; -o-border-radius: 100px; border-radius: 100px; }
	button[is='naff-x-icon-button'][shape='rounded'] { -webkit-border-radius: 5px; -moz-border-radius: 5px; -ms-border-radius: 5px; -o-border-radius: 5px; border-radius: 5px; }
	button[is='naff-x-icon-button'][shape='oval'] { -webkit-border-radius: 75% / 77%; -moz-border-radius: 75% / 77%; -ms-border-radius: 75% / 77%; -o-border-radius: 75% / 77%; border-radius: 75% / 77%; }
	button[is='naff-x-icon-button'][color='grey'] { border: 1px solid #bbb; background: #ddd; color: #222; }
	button[is='naff-x-icon-button'][color='blue'] { border: 1px solid blue; background: rgb(74, 74, 255); color: #fff; }
	button[is='naff-x-icon-button'][color='red'] { border: 1px solid red; background: rgb(255, 44, 44); color: #fff; }
	button[is='naff-x-icon-button'][color='green'] { border: 1px solid green; background: rgb(18, 163, 18); color: #fff; }
	button[is='naff-x-icon-button'][color='orange'] { border: 1px solid rgb(255, 118, 26); background: rgb(255, 136, 26); color: #fff; }
	button[is='naff-x-icon-button'][color='black'] { border: 1px solid #111; background: #222; color: #fff; }
	button[is='naff-x-icon-button'][color='pink'] { border: 1px solid #991C97; background: #D729D5; color: #fff; }
	button[is='naff-x-icon-button'][color='purple'] { border: 1px solid #440869; background: #8913D4; color: #fff; }
	button[is='naff-x-icon-button'][color='yellow'] { border: 1px solid #CCCC36; background: #E5E522; color: #444; }
	button[is='naff-x-icon-button'][color='aqua'] { border: 1px solid #308FB1; background: #31AEDB; color: #FFF; }
	button[is='naff-x-icon-button'][color='white'] { border: 1px solid #ccc; background: #FFFFFF; color: #444; }
</style>

<!-- TEMPLATE -->
<template id="naff-x-icon-button">
	<naff-icon></naff-icon>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-x-icon-button',
		extends: 'button',

		created: function()
		{
			// set initial value of icon from parent attributes
			this.template.querySelector('naff-icon').setAttribute('name', this.host.getAttribute('name'));
			if (this.host.hasAttribute('spin')) this.template.querySelector('naff-icon').setAttribute('spin', 'spin');
			if (this.host.hasAttribute('pulse')) this.template.querySelector('naff-icon').setAttribute('pulse', 'pulse');
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			// iterate over changes
			switch (name)
			{
				case 'name': this.template.querySelector('naff-icon').setAttribute('name', newVal); break;
				case 'spin':
				case 'pulse':
					if (this.host.hasAttribute(name)) this.template.querySelector('naff-icon').setAttribute(name, name);
					else this.template.querySelector('naff-icon').removeAttribute(name);
				break;
			}
		}
	});
</script>

<style>
	select[is="naff-x-select"] { padding: 2px 5px; border: none; border-bottom: 2px solid #888; outline: none; font-size: 15px; background: transparent; }
	select[is="naff-x-select"]:focus:not([disabled]), select[is="naff-x-select"]:active:not([disabled]) { border-bottom-width: 2px; border-color: #444; }
	select[is="naff-x-select"][disabled] { cursor: not-allowed; border-bottom: 2px dashed #888; background-color: #fff; }
</style>

<!-- LOGIC -->
<script>naff.registerElement({name: 'naff-x-select'});</script>


<style>
	naff-message { padding: 10px; position: fixed; opacity: 0; text-align: center; background-color: #444; color: #fff; font-size: 14px; display: none; max-width: 80%; z-index: 3000; -webkit-box-shadow: 0px 0px 30px 0px rgba(40, 40, 40, 0.61); -moz-box-shadow: 0px 0px 30px 0px rgba(40, 40, 40, 0.61); -ms-box-shadow: 0px 0px 30px 0px rgba(40, 40, 40, 0.61); -o-box-shadow: 0px 0px 30px 0px rgba(40, 40, 40, 0.61); box-shadow: 0px 0px 30px 0px rgba(40, 40, 40, 0.61); -webkit-border-radius: 2px; -moz-border-radius: 2px; -ms-border-radius: 2px; -0-border-radius: 2px; border-radius: 2px; -webkit-transition: opacity .3s ease-in-out; -moz-transition: opacity .3s ease-in-out; -ms-transition: opacity .3s ease-in-out; -o-transition: opacity .3s ease-in-out; transition: opacity .3s ease-in-out; }
	naff-message[position='top'] { top: 20px; left: 50%; text-align: center; }
	naff-message[position='bottom'] { bottom: 20px; left: 50%; text-align: center; }
	naff-message[position='top-left'] { top: 20px; left: 20px; text-align: left; }
	naff-message[position='top-right'] { top: 20px; right: 20px; text-align: right; }
	naff-message[position='bottom-left'] { bottom: 20px; left: 20px; text-align: left; }
	naff-message[position='bottom-right'] { bottom: 20px; right: 20px; text-align: right; }
	naff-message[color='red'] { background-color: rgb(255, 44, 44); }
	naff-message[color='blue'] { background-color: rgb(74, 74, 255); }
	naff-message[color='green'] { background-color: rgb(18, 163, 18); }
	naff-message[color='orange'] { background-color: rgb(255, 136, 26); }
	naff-message[color='white'] { background-color: #f4f4f4; color: #444; }
	naff-message.-jiggle { -webkit-animation-name: -naff-message-jiggle; -webkit-animation-duration: 0.4s; -webkit-animation-iteration-count: 1; -webkit-animation-timing-function: linear; -webkit-transform-origin: 50% 100%; -moz-animation-name: -naff-message-jiggle; -moz-animation-duration: 0.4s; -moz-animation-iteration-count: 1; -moz-animation-timing-function: linear; -moz-transform-origin: 50% 100%; -ms-animation-name: -naff-message-jiggle; -ms-animation-duration: 0.4s; -ms-animation-iteration-count: 1; -ms-animation-timing-function: linear; -ms-transform-origin: 50% 100%; -o-animation-name: -naff-message-jiggle; -o-animation-duration: 0.4s; -o-animation-iteration-count: 1; -o-animation-timing-function: linear; -o-transform-origin: 50% 100%; animation-name: -naff-message-jiggle; animation-duration: 0.4s; animation-iteration-count: 1; animation-timing-function: linear; transform-origin: 50% 100%; }
	@-webkit-keyframes -naff-message-jiggle { 0% { -webkit-transform: translate(2px, 1px) rotate(0deg); } 10% { -webkit-transform: translate(-1px, -2px) rotate(-2deg); }	20% { -webkit-transform: translate(-3px, 0px) rotate(3deg); } 30% { -webkit-transform: translate(0px, 2px) rotate(0deg); } 40% { -webkit-transform: translate(1px, -1px) rotate(1deg); } 50% { -webkit-transform: translate(-1px, 2px) rotate(-1deg); } 60% { -webkit-transform: translate(-3px, 1px) rotate(0deg); } 70% { -webkit-transform: translate(2px, 1px) rotate(-2deg); } 80% { -webkit-transform: translate(-1px, -1px) rotate(4deg); } 90% { -webkit-transform: translate(2px, 2px) rotate(0deg); } 100% { -webkit-transform: translate(1px, -2px) rotate(-1deg); }	}
	@-moz-keyframes -naff-message-jiggle { 0% { -moz-transform: translate(2px, 1px) rotate(0deg); } 10% { -moz-transform: translate(-1px, -2px) rotate(-2deg); } 20% { -moz-transform: translate(-3px, 0px) rotate(3deg); } 30% { -moz-transform: translate(0px, 2px) rotate(0deg); } 40% { -moz-transform: translate(1px, -1px) rotate(1deg); } 50% { -moz-transform: translate(-1px, 2px) rotate(-1deg); } 60% { -moz-transform: translate(-3px, 1px) rotate(0deg); } 70% { -moz-transform: translate(2px, 1px) rotate(-2deg); } 80% { -moz-transform: translate(-1px, -1px) rotate(4deg); } 90% { -moz-transform: translate(2px, 2px) rotate(0deg); } 100% { -moz-transform: translate(1px, -2px) rotate(-1deg); } }
	@-ms-keyframes -naff-message-jiggle { 0% { -ms-transform: translate(2px, 1px) rotate(0deg); } 10% { -ms-transform: translate(-1px, -2px) rotate(-2deg); } 20% { -ms-transform: translate(-3px, 0px) rotate(3deg); } 30% { -ms-transform: translate(0px, 2px) rotate(0deg); } 40% { -ms-transform: translate(1px, -1px) rotate(1deg); } 50% { -ms-transform: translate(-1px, 2px) rotate(-1deg); } 60% { -ms-transform: translate(-3px, 1px) rotate(0deg); } 70% { -ms-transform: translate(2px, 1px) rotate(-2deg); } 80% { -ms-transform: translate(-1px, -1px) rotate(4deg); } 90% { -ms-transform: translate(2px, 2px) rotate(0deg); } 100% { -ms-transform: translate(1px, -2px) rotate(-1deg); } }
	@-o-keyframes -naff-message-jiggle { 0% { -o-transform: translate(2px, 1px) rotate(0deg); } 10% { -o-transform: translate(-1px, -2px) rotate(-2deg); } 20% { -o-transform: translate(-3px, 0px) rotate(3deg); } 30% { -o-transform: translate(0px, 2px) rotate(0deg); } 40% { -o-transform: translate(1px, -1px) rotate(1deg); } 50% { -o-transform: translate(-1px, 2px) rotate(-1deg); } 60% { -o-transform: translate(-3px, 1px) rotate(0deg); } 70% { -o-transform: translate(2px, 1px) rotate(-2deg); } 80% { -o-transform: translate(-1px, -1px) rotate(4deg); } 90% { -o-transform: translate(2px, 2px) rotate(0deg); } 100% { -o-transform: translate(1px, -2px) rotate(-1deg); } }
	@keyframes -naff-message-jiggle { 0% { transform: translate(2px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-2deg); } 20% { transform: translate(-3px, 0px) rotate(3deg); } 30% { transform: translate(0px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(2px, 1px) rotate(-2deg); } 80% { transform: translate(-1px, -1px) rotate(4deg); } 90% { transform: translate(2px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
</style>

<!-- TEMPLATE -->
<template id="naff-message">
	<content></content>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-message',

		toggle: 0,

		private: {
			delay: 4,
			opacityTimer: null,
			displayTimer: null,
			messageTimer: null
		},

		created: function()
		{
			// Initial setup
			if (this.host.hasAttribute('delay')) this.private.delay = parseInt(this.host.getAttribute('delay'));
			if (this.host.hasAttribute('toggle')) this.toggle = this.host.getAttribute('toggle');
			else this.host.setAttribute('toggle', this.toggle);
			this.show(true);
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			if (name == 'delay') this.private.delay = parseInt(newVal);
			if (name =='toggle')
			{
				this.toggle = newVal == 1 ? 1 : 0;
				this.show(true);
			}
		},

		show: function(internal)
		{
			var scope = this;
			if (internal && scope.toggle != 1) return;
			scope.fire('show');
			scope.host.setAttribute('toggle', 0);

			// jiggle toast if re-thrown or show for first time
			if (!!scope.private.messageTimer)
			{
				clearTimeout(scope.private.messageTimer);
				clearTimeout(scope.private.displayTimer);
				if ("bottom" === scope.host.getAttribute('position') || "top" === scope.host.getAttribute('position')) scope.host.style.marginLeft = "-" + scope.host.offsetWidth/2 + "px";

				setTimeout(function()
				{
					scope.fire('jiggle');
					scope.host.className += " -jiggle";

					setTimeout(function() { scope.host.className = scope.host.className.replace(/ -jiggle/g, "") }, 750);
				}, 1);
			}
			else
			{
				scope.host.style.display = "block";

				setTimeout(function()
				{
					if ("bottom" === scope.host.getAttribute('position') || "top" === scope.host.getAttribute('position')) scope.host.style.marginLeft = "-" + scope.host.offsetWidth/2 + "px";
					scope.host.style.opacity = 1;
				}, 1);
			}

			// set timing of show/hide
			scope.private.messageTimer = setTimeout(function()
			{
				scope.host.style.opacity = 0;
				scope.private.displayTimer = setTimeout(function()
				{
					scope.host.style.display = "none";
					scope.private.messageTimer = null;
					scope.private.displayTimer = null;
					scope.host.setAttribute('toggle', 0);
					scope.fire('hide');
				}, 300);
			}, scope.private.delay * 1000);
		}
	});
</script>



<!-- STYLE - Encapsulate all css to tag name -->
<style>
	naff-modal { display: none; opacity: 0; position: fixed; z-index: 2000; width: 50%; max-width: 95%; top: 50%; left: 50%; background-color: white; box-shadow: 0 0 40px -10px #888; border: 1px solid #ccc; border-radius: 2px; -webkit-transition: opacity .2s ease-in-out; -moz-transition: opacity .2s ease-in-out; -ms-transition: opacity .2s ease-in-out; -o-transition: opacity .2s ease-in-out; transition: opacity .2s ease-in-out; }
	@media (max-width:500px) { naff-modal { width: 97% !important; } }
	naff-modal .-heading { padding: 10px; border-bottom: 1px solid #ddd; min-height: 30px; }
	naff-modal .-heading heading { padding: 0px 40px 0px 0px; font-size: 20px; line-height: 30px; font-weight: bold; color: #555;}
	naff-modal .-heading .-close { opacity: 0.8; position: absolute; top: 10px; right: 10px; }
	naff-modal .-heading .-close:hover { opacity: 1; }
	naff-modal main { display: block; padding: 10px; overflow: auto; box-sizing: border-box; width: 99.9%; max-height: 500px; }
	naff-modal footer { display: block; padding: 10px; border-top: 1px solid #ddd; text-align: right; }
</style>

<!-- TEMPLATE -->
<template id="naff-modal">
	<div class="-heading">
		<content select="heading"></content>
		<!-- <naff-icon class="-close" name="times" naff-on-click="hide()"></naff-icon> -->
		<button is="naff-x-icon-button" class="-close" name="times" shape="round" color="red" size="medium" naff-on-click="hide()"></button>
	</div>
	<content select="main"></content>
	<content select="footer"></content>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-modal',
		dataBind: true,

		toggle: 0,

		private: {
			resize: null
		},

		created: function()
		{
			this.private.resize = this.resize.bind(this);

			// Initial setup
			if (this.host.hasAttribute('toggle')) this.toggle = this.host.getAttribute('toggle');
			else this.host.setAttribute('toggle', this.toggle);
			if (this.toggle == 1) this.show(true);
			else this.hide();
		},

		attached: function()
		{
			if (!this.template.querySelector('heading'))
			{
				var heading = this.template.querySelector('.-heading');
				heading.parentNode.removeChild(heading);
			}
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			if (name =='toggle')
			{
				this.toggle = newVal == 1 ? 1 : 0;
				if (this.toggle == 1) this.show(true);
				else this.hide();
			}
		},

		show: function(internal)
		{
			var scope = this;

			window.addEventListener('resize', scope.private.resize);

			scope.host.style.display = "block";

			setTimeout(function(){
				scope.host.style.opacity = 1;
				document.body.style.overflow = 'hidden';
				scope.resize();
				scope.fire('show');
			}, 0);
		},

		hide: function()
		{
			var scope = this;

			window.removeEventListener('resize', scope.private.resize);

			scope.host.style.opacity = 0;

			setTimeout(function(){
				scope.host.style.display = "none";
				document.body.style.overflow = 'auto';
				scope.host.setAttribute('toggle', 0);
				scope.fire('hide');
			}, 200);
		},

		resize: function()
		{
			var main = this.template.querySelector('main');
			if (main) main.style.maxHeight = ((window.innerHeight + main.offsetHeight - this.host.offsetHeight) / 100) * 90 + 'px';

			var marginTop = (this.host.offsetHeight - (this.host.offsetHeight * 2)) / 2;
			var marginLeft = (this.host.offsetWidth - (this.host.offsetWidth * 2)) / 2;
			this.host.style.margin = marginTop + 'px 0 0 ' + marginLeft + 'px';
		}
	});
</script>





<!-- STYLE - Encapsulate all css to tag name -->
<style>
	naff-date-picker naff-modal.-date-picker-modal { width: 300px; }
	naff-date-picker .-container .-controls { display: block; width: 100%; text-align: center; overflow: hidden; margin-bottom: 10px; }
	naff-date-picker .-container .-controls .-tag-box { width: 130px; display: inline-block; }
	naff-date-picker .-container .-controls .-tag-box .-in-month	{ background-color: #555; color: #eee; line-height: 18px; }
	naff-date-picker .-container .-controls .-close { position: absolute; right: 10px; }
	naff-date-picker .-container .-controls .-close:hover { opacity: 1; }
	naff-date-picker .-container .-frame { position: relative; }
	naff-date-picker .-container .-frame .-picker { width: 100%; display: block; margin: 0; padding: 0; }
	naff-date-picker .-container .-frame .-picker .-picker-day { width: 14.28%; display: inline-block; cursor: pointer; box-sizing: border-box; list-style-type: none; padding: 1px;	}
	naff-date-picker .-container .-frame .-picker .-picker-day .-details { width: 100%; text-align: center; box-sizing: border-box;	background-color: #f4f4f4; border: solid 1px #ddd; padding: 8px 6px 6px 6px; }
	naff-date-picker .-container .-frame .-picker .-picker-day[today="true"] .-details { font-weight: bolder; }
	naff-date-picker .-container .-frame .-picker .-picker-day:hover .-details, naff-date-picker .-container .-frame .-picker .-picker-day[selected="true"] .-details { background-color: #E5EEFF; border: solid 1px #B5CEFC; }
	naff-date-picker .-container .-frame .-picker .-picker-day[disabled] .-details { opacity: 0.5; cursor: not-allowed; background: #fff; border: solid 1px #ddd; }
	naff-date-picker .-container .-frame .-picker .-picker-day .-details .-date { font-size: 16px; line-height: 12px; display: block; }
	naff-date-picker .-container .-frame .-picker .-picker-day .-details .-day { font-size: 10px; padding-top: 0px; display: block; }
</style>

<!-- TEMPLATE -->
<template id="naff-date-picker">
	<naff-modal class="-date-picker-modal" naff-toggle="toggle">
		<main>
			<div class="-container">
		        <div class="-controls">
					<button is="naff-x-icon-button" size="medium" shape="round" color="grey" name="chevron-left" naff-on-click="previousMonth()"></button>
					<div class="-tag-box">
						<naff-tag class="-in-month" shape="round" naff-text="private.date | date 'mmmm yyyy'"></naff-tag>
					</div>
					<button is="naff-x-icon-button" size="medium" shape="round" color="grey" name="chevron-right" naff-on-click="nextMonth()"></button>
					<button is="naff-x-icon-button" class="-close" name="times" shape="round" color="red" size="medium" naff-on-click="hide()"></button>
		        </div>
				<div class="-frame">
			        <ul class="-picker">
				        <li naff-each-day="private.days" naff-on-click="selectDay()" naff-selected="day.date | equals private.selectedDate" class="-picker-day" naff-today="day.today" naff-day-id="day.id" naff-disabled="day.disabled">
							<div class="-details">
								<span class="-date" naff-text="day.dom"></span>
								<span class="-day" naff-text="day.day"></span>
							</div>
						</li>
			        </ul>
				</div>
			</div>
		</main>
	</naff-modal>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-date-picker',
		dataBind: true,
		toggle: 0,
		date: null,
		format: 'yyyy-mm-dd',

		// private properties
		private: {
			today: null,
			date: null,
			days: [],
			selected: null,
			selectedDate: null,
			events: []
		},

		created: function()
		{
			if (this.host.hasAttribute('format')) this.format = this.host.getAttribute('format');
			if (this.host.hasAttribute('date')) this.date = this.host.getAttribute('date');
			this.private.selected = this.date ? new Date(Date.parse(this.date)) : new Date(Date.now());
			this.private.selectedDate = dateFormat(this.private.selected, 'yyyy-mm-dd');
		},

		attached: function()
		{
			this.load();
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			switch (name)
			{
				case 'date':
					this.date = newVal;
					this.private.selected = this.date ? new Date(Date.parse(this.date)) : new Date(Date.now());
					this.private.selectedDate = dateFormat(this.private.selected, 'yyyy-mm-dd');
				break;
				case 'format':
					this.format = newVal || 'yyyy-mm-dd';
				break;
				case 'toggle':
					if (newVal == 0) this.toggle = 0;
					else
					{
						this.toggle = 1;
						this.load();
					}
				break;
			}
		},

		show: function()
		{
			this.host.setAttribute('toggle', 1);
			this.load();
		},

		hide: function()
		{
			this.host.setAttribute('toggle', 0);
		},

		load: function()
		{
			this.private.today = new Date();

			// work out start point for calendar
			var newDate = new Date();
			newDate.setDate(1);
			newDate.setMonth(this.private.selected.getMonth());
			newDate.setFullYear(this.private.selected.getFullYear());

			this.private.date = newDate;
			this.createMonth();

			if (this.host.hasAttribute('toggle')) this.template.querySelector('naff-modal');
		},

		// Clears the calendar and shows the next month
		nextMonth: function()
		{
		    var newDate = new Date(this.private.date);
			newDate.setMonth(newDate.getMonth() + 1);
			this.private.date = newDate;
		    this.createMonth();
			this.fire('change', dateFormat(this.private.date, 'yyyy-mm-dd'));
		},

		// Clears the calendar and shows the previous month
		previousMonth: function()
		{
		    var newDate = new Date(this.private.date);
			newDate.setMonth(newDate.getMonth() - 1);
			this.private.date = newDate;
		    this.createMonth();
			this.fire('change', dateFormat(this.private.date, 'yyyy-mm-dd'));
		},

		// Creates and populates all of the days to make up the month
		createMonth: function()
		{
			this.private.days = [];

		    var dateObject = new Date();
		    dateObject.setDate(this.private.date.getDate());
		    dateObject.setMonth(this.private.date.getMonth());
		    dateObject.setYear(this.private.date.getFullYear());

			// rewind to a monday
			while (dateObject.getDay() != 1) dateObject.setDate(dateObject.getDate() - 1);

			// do the first monday to get past loop
			this.private.days.push({
				'id': this.private.days.length,
				'date': dateFormat(dateObject, 'yyyy-mm-dd'),
				'dom': dateFormat(dateObject, 'dd'),
				'day': dateFormat(dateObject, 'ddd'),
				'today': dateFormat(dateObject, 'yyyy-mm-dd') == dateFormat(this.private.today, 'yyyy-mm-dd'),
				'disabled': dateObject.getMonth() != this.private.date.getMonth()
			});
			dateObject.setDate(dateObject.getDate() + 1);

			// now loop until we hit the next monday that is not in the month we selected
			while (!(dateObject.getDay() == 1 && dateObject.getMonth() != this.private.date.getMonth()))
			{
				this.private.days.push({
					'id': this.private.days.length,
					'date': dateFormat(dateObject, 'yyyy-mm-dd'),
					'dom': dateFormat(dateObject, 'dd'),
					'day': dateFormat(dateObject, 'ddd'),
					'today': dateFormat(dateObject, 'yyyy-mm-dd') == dateFormat(this.private.today, 'yyyy-mm-dd'),
					'disabled': dateObject.getMonth() != this.private.date.getMonth()
				});
				dateObject.setDate(dateObject.getDate() + 1);
			}
		},

		selectDay: function(ev)
		{
			var el = ev.target;
			while (el.className != '-picker-day') el = el.parentNode;
			if (el.hasAttribute('disabled')) return;
			this.private.selected = new Date(this.private.days[el.getAttribute('day-id')].date);
			this.private.selectedDate = dateFormat(this.private.selected, 'yyyy-mm-dd');
			this.host.setAttribute('date', dateFormat(this.private.selected, this.format));
			this.host.setAttribute('toggle', 0);
			this.fire('select', dateFormat(this.private.selected, this.format));
		}
	});
</script>




<!-- STYLE - Encapsulate all css to tag name -->
<style>
	naff-time-picker naff-modal.-date-picker-modal { width: 300px; }
	naff-time-picker .-container .-controls { display: block; width: 100%; text-align: center; overflow: hidden; }
	naff-time-picker .-container .-controls .-tag-box { width: 150px; display: inline-block; }
	naff-time-picker .-container .-controls .-tag-box button { margin-left: 8px; margin-right: 8px; }
	naff-time-picker .-container .-controls .-close { position: absolute; right: 10px; }
	naff-time-picker .-container .-controls .-close:hover { opacity: 1; }
	naff-time-picker .-container .-frame { position: relative; }
	naff-time-picker .-container .-frame .-time { font-family: monospace; font-size: 30px; font-weight: bold; color: #444; text-align: center; padding: 20px; }
</style>

<!-- TEMPLATE -->
<template id="naff-time-picker">
	<naff-modal class="-date-picker-modal" naff-toggle="toggle">
		<main>
			<div class="-container">
		        <div class="-controls -above">
					<div class="-tag-box">
						<button is="naff-x-icon-button" naff-if="private.showHour" size="medium" shape="round" color="grey" name="chevron-up" naff-on-click="setHour('1')"></button>
						<button is="naff-x-icon-button" naff-if="private.showMin" size="medium" shape="round" color="grey" name="chevron-up" naff-on-click="setMin('1')"></button>
						<button is="naff-x-icon-button" naff-if="private.showSec" size="medium" shape="round" color="grey" name="chevron-up" naff-on-click="setSec('1')"></button>
					</div>
					<button is="naff-x-icon-button" class="-close" name="times" shape="round" color="red" size="medium" naff-on-click="hide()"></button>
		        </div>
				<div class="-frame">
					<div class="-time">
						{{private.time}}
					</div>
				</div>
		        <div class="-controls -below">
					<div class="-tag-box">
						<button is="naff-x-icon-button" naff-if="private.showHour" size="medium" shape="round" color="grey" name="chevron-down" naff-on-click="setHour('-1')"></button>
						<button is="naff-x-icon-button" naff-if="private.showMin" size="medium" shape="round" color="grey" name="chevron-down" naff-on-click="setMin('-1')"></button>
						<button is="naff-x-icon-button" naff-if="private.showSec" size="medium" shape="round" color="grey" name="chevron-down" naff-on-click="setSec('-1')"></button>
					</div>
					<button is="naff-x-icon-button" class="-close" name="check" shape="round" color="green" size="medium" naff-on-click="selectTime()"></button>
		        </div>
			</div>
		</main>
	</naff-modal>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-time-picker',
		dataBind: true,
		toggle: 0,
		time: null,
		format: 'HH:MM',

		// private properties
		private: {
			time: null,
			date: null,
			showHour: true,
			showMin: true,
			showSec: true
		},

		created: function()
		{
			if (this.host.hasAttribute('format')) this.format = this.host.getAttribute('format');
			if (this.host.hasAttribute('time')) this.time = this.host.getAttribute('time');
			this.private.showHour = this.format.indexOf('h') >= 0 || this.format.indexOf('H') >= 0 ? true : false;
			this.private.showMin = this.format.indexOf('M') >= 0 ? true : false;
			this.private.showSec = this.format.indexOf('s') >= 0 ? true : false;
			this.setDateTime();
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			switch (name)
			{
				case 'time':
					this.time = newVal;
					this.setDateTime();
				break;
				case 'format':
					this.format = newVal || 'HH:MM';
					this.private.showHour = this.format.indexOf('h') >= 0 || this.format.indexOf('H') >= 0 ? true : false;
					this.private.showMin = this.format.indexOf('M') >= 0 ? true : false;
					this.private.showSec = this.format.indexOf('s') >= 0 ? true : false;
					this.setDateTime();
				break;
				case 'toggle':
					if (newVal == 0) this.toggle = 0;
					else
					{
						this.toggle = 1;
					}
				break;
			}
		},

		show: function()
		{
			this.host.setAttribute('toggle', 1);
		},

		hide: function()
		{
			this.host.setAttribute('toggle', 0);
		},

		setDateTime: function()
		{
			// correct any bad formatting before parsing time
			this.private.date = this.time ? new Date(Date.parse('2015-01-01 ' + (this.format.indexOf('H') >= 0 && (this.format.indexOf('t') >= 0 || this.format.indexOf('T') >= 0) ? this.time.replace(/am|pm/i, '').trim() : this.time))) : new Date(Date.now());
			this.private.time = dateFormat(this.private.date, this.format);
		},

		setHour: function(ev, val)
		{
			this.private.date.setHours(this.private.date.getHours() + parseInt(val));
			this.private.time = dateFormat(this.private.date, this.format);
			this.fire('change', this.private.time);
		},

		setMin: function(ev, val)
		{
			this.private.date.setMinutes(this.private.date.getMinutes() + parseInt(val));
			this.private.time = dateFormat(this.private.date, this.format);
			this.fire('change', this.private.time);
		},

		setSec: function(ev, val)
		{
			this.private.date.setSeconds(this.private.date.getSeconds() + parseInt(val));
			this.private.time = dateFormat(this.private.date, this.format);
			this.fire('change', this.private.time);
		},

		selectTime: function(ev)
		{
			this.host.setAttribute('time', this.private.time);
			this.host.setAttribute('toggle', 0);
			this.fire('select', this.private.time);
		}
	});
</script>


<script>
	// build scope
	naff.registerElement({
		name: 'naff-partial',

		private: {
			basepath: null,
			partial: null
		},

		created: function()
		{
			// Initial setup
			if (this.host.hasAttribute('basepath')) this.private.basepath = this.host.getAttribute('basepath');
			if (this.host.hasAttribute('partial')) this.private.partial = this.host.getAttribute('partial');
			this.load();
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			if (name == 'basepath') this.private.basepath = newVal;
			if (name == 'partial') this.private.partial = newVal;
			this.load();
		},

		load: function()
		{
			if (this.private.partial === null) return;

			// retrict urls to html, htm files only
			var path = this.private.basepath === null ? '' : (this.private.basepath.substr(-1) !== '/' ? this.private.basepath : this.private.basepath.substring(0, this.private.basepath.length - 1));
			var partial = path + (path.length > 1 ? '/' : '') + this.private.partial.split('.')[0] + '.html';

			// do async request to grab content
			var XHR = XMLHttpRequest || ActiveXObject;
			var request = new XHR('MSXML2.XMLHTTP.3.0');
			var scope = this;
			request.open('GET', partial, true);
			request.onreadystatechange = function ()
			{
				if (request.readyState === 4)
				{
					if (request.status === 200)
					{
						scope.host.innerHTML = request.response;
						scope.fire('loaded');
					}
					else throw 'naff-partial: Error loading partial [' + partial + ']';
				}
			};
			request.send();
		}
	});
</script>




<!-- STYLE - Encapsulate all css to tag name -->
<style>
	naff-menu * { color: #555; }
	naff-menu { display: block; margin: 0; padding: 0; box-sizing: border-box; width: 225px; height: 100%; background-color: #eee; color: #222; position: fixed; top: 0px; z-index: 1000; overflow: auto; max-height: 100%; }
	naff-menu[position="left"] { left: 0px; }
	naff-menu[position="right"] { right: 0px; }
	naff-menu ul { margin: 0px; padding: 0px; color: inherit; list-style-type: none; }
	naff-menu * { color: inherit; }
	naff-menu > ul > li { border-top: 1px solid rgba(0, 0, 0, 0.1); }
	naff-menu > ul > li:last-child { border-bottom: 1px solid rgba(0, 0, 0, 0.1); }
	naff-menu ul li span { display: inherit; padding: 5px; font-size: 14px; line-height: 30px; cursor: pointer; color: inherit; opacity: 0.85; }
	naff-menu ul li span naff-icon { text-align: center; color: inherit; width: 2em; }
	naff-menu ul li[selected] > span { background-color: rgba(0, 0, 0, 0.1); }
	naff-menu ul li:hover > span { opacity: 1; }
	naff-menu ul li ul li span { padding-left: 15px; }
	naff-menu ul li ul li ul li span { padding-left: 25px; }
	naff-menu ul li ul li ul li ul li span { padding-left: 35px; }
	naff-menu ul li ul li ul li ul li ul li span { padding-left: 45px; }
	naff-menu naff-icon[name="bars"] { display: none; }
	naff-menu[children="expandable"] ul li ul { display: none; }
	naff-menu[children="expandable"] ul li[selected] > ul, naff-menu[children="expandable"] ul li ul[active] { display: block; }
	naff-menu ._side-logo, naff-menu ._top-logo { display: none; }
	naff-menu ._top-logo ._top-logo-text, naff-menu ._side-logo ._side-logo-text { min-height: 40px; line-height: 40px; opacity: 0.85; cursor: pointer; }
	naff-menu ._top-logo img, naff-menu ._side-logo img { cursor: pointer; }
	@media (max-width:600px) { naff-menu { width: 100%; height: auto; top: 0px; left: 0px; } naff-menu naff-icon[name="bars"] { font-size: 18px; line-height: 40px; opacity: 0.85; display: block; position: absolute; top: 0px; right: 8px; cursor: pointer; } naff-menu naff-icon[name="bars"]:hover, naff-menu naff-icon[name="bars"]:active, naff-menu naff-icon[name="bars"]:focus { opacity: 1; } naff-menu ._top-logo { display: inline-block; height: 40px; } naff-menu ._top-logo img { display: inline-block; height: 36px; margin-left: 2px; margin-top: 2px; float: left; } naff-menu ._top-logo ._top-logo-text { display: inline-block; padding-left: 5px; } naff-menu ._top-logo ._top-logo-text:empty { display: inline; } }
	@media (min-width:601px) { naff-menu > ul, naff-menu ._content { display: block !important; } naff-menu ._side-logo-text { display: block; } naff-menu ._side-logo-text:empty { display: none; } naff-menu ._side-logo img { margin-top: 10px; margin-bottom: 10px; display: inline-block; max-width: 100%; } naff-menu ._side-logo { display: block; text-align: center; width: 100%; } }
</style>

<!-- TEMPLATE -->
<template id="naff-menu">
	<div class="_side-logo">
		<img naff-if="private.sideLogo" naff-src="private.sideLogo" naff-route="private.defaultRoute" naff-on-click="changeRoute()" default="" alt="logo">
		<span class="_side-logo-text" naff-text="private.sideLogoText" naff-route="private.defaultRoute" naff-on-click="changeRoute()" default=""></span>
	</div>
	<div class="_top-logo">
		<img naff-if="private.topLogo" naff-src="private.topLogo" naff-route="private.defaultRoute" naff-on-click="changeRoute()" default="" alt="logo">
		<span class="_top-logo-text" naff-text="private.topLogoText" naff-route="private.defaultRoute" naff-on-click="changeRoute()" default=""></span>
	</div>
	<ul naff-show="toggle">
		<li naff-each-item="attributes.menu-items" naff-route="item.route" naff-on-click="changeRoute()">
			<span><naff-icon naff-name="item.icon" naff-if="item.icon"></naff-icon>{{item.label}}</span>
			<ul naff-if="item.menuItems">
				<li naff-each-item2="item.menuItems" naff-route="item2.route" naff-on-click="changeRoute()">
					<span><naff-icon naff-name="item2.icon" naff-if="item2.icon"></naff-icon>{{item2.label}}</span>
					<ul naff-if="item2.menuItems">
						<li naff-each-item3="item2.menuItems" naff-route="item3.route" naff-on-click="changeRoute()">
							<span><naff-icon naff-name="item3.icon" naff-if="item3.icon"></naff-icon>{{item3.label}}</span>
							<ul naff-if="item3.menuItems">
								<li naff-each-item4="item3.menuItems" naff-route="item4.route" naff-on-click="changeRoute()">
									<span><naff-icon naff-name="item4.icon" naff-if="item4.icon"></naff-icon>{{item4.label}}</span>
									<ul naff-if="item4.menuItems">
										<li naff-each-item5="item4.menuItems" naff-route="item5.route" naff-on-click="changeRoute()">
											<span><naff-icon naff-name="item5.icon" naff-if="item5.icon"></naff-icon>{{item5.label}}</span>
										</li>
									</ul>
								</li>
							</ul>
						</li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<naff-icon name="bars" naff-on-click="toggleMenu()"></naff-icon>
	<div class="_content" naff-show="toggle">
		<content></content>
	</div>
</template>

<!-- LOGIC -->
<script>
	// build scope
	naff.registerElement({
		name: 'naff-menu',
		dataBind: true,

		toggle: false,

		private: {
			route: null,
			defaultRoute: '',
			sideLogoText: null,
			topLogoText: null,
			sideLogo: null,
			topLogo: null
		},

		created: function()
		{
			// Initial setup
			if (this.host.hasAttribute('side-logo')) this.private.sideLogo = this.host.getAttribute('side-logo');
			if (this.host.hasAttribute('top-logo')) this.private.topLogo = this.host.getAttribute('top-logo');
			if (this.host.hasAttribute('side-logo-text')) this.private.sideLogoText = this.host.getAttribute('side-logo-text');
			if (this.host.hasAttribute('top-logo-text')) this.private.topLogoText = this.host.getAttribute('top-logo-text');
			if (this.host.hasAttribute('menu-items')) this.setMenuItems(this.host.getAttribute('menu-items'));
			if (this.host.hasAttribute('default-route')) this.private.defaultRoute = this.host.getAttribute('default-route');

			var location = naff.getLocation();
			if (this.host.hasAttribute('default-route') && location.route.length < 1) {
				this.private.route = this.host.getAttribute('default-route');
				naff.setLocation({route: this.private.route});
			} else {
				this.private.route = location.route;
				this.host.setAttribute('route', this.private.route);
			}

			var scope = this;
			sightglass(this.attributes, 'menu-items', function() {
			  	scope.updateSelected();
			});
		},

		attributeChanged: function(name, oldVal, newVal)
		{
			switch (name)
			{
				case 'menu-items': this.setMenuItems(newVal); break;
				case 'route': this.private.route = newVal; break;
				case 'side-logo': this.private.sideLogo = newVal; break;
				case 'top-logo': this.private.topLogo = newVal; break;
				case 'side-logo-text': this.private.sideLogoText = newVal; break;
				case 'top-logo-text': this.private.topLogoText = newVal; break;
				case 'default-route': this.private.defaultRoute = newVal; break;
			}
			this.updateSelected();
		},

		location: function(newLoc, oldLoc)
		{
			if (oldLoc) this.host.setAttribute('route', newLoc.route);
		},

		changeRoute: function(event)
		{
			var parent = event.target;
			while (parent.tagName != 'LI' && !parent.hasAttribute('default')) parent = parent.parentNode;
			if (parent.hasAttribute('route')) {
				naff.setLocation({route: parent.getAttribute('route')});
				this.toggle = false;
			} else {
				var list = parent.querySelector('ul');
				if (list.hasAttribute('active')) list.removeAttribute('active');
				else list.setAttribute('active', '');
			}

			event.stopPropagation();
		},

		toggleMenu: function()
		{
			this.toggle = !this.toggle;
		},

		updateSelected: function()
		{
			var items = this.template.querySelectorAll('li');
			for (var i = 0; i < items.length; i++) {
				if (items[i].getAttribute('route') == this.private.route) items[i].setAttribute('selected', '');
				else items[i].removeAttribute('selected');
			}

			var list = this.template.querySelectorAll('ul');
			for (var i = 0; i < list.length; i++) {
				if (list[i].querySelectorAll('li[selected]').length > 0) list[i].setAttribute('active', '');
				else list[i].removeAttribute('active');
			}
		},

		setMenuItems: function(menuItems)
		{
			if (menuItems.indexOf('object bound') == 0) return;
			try {
				if (typeof this.attribtues === 'undefined') this.attributes = {};
				this.attributes['menu-items'] = JSON.parse(menuItems.replace(/[\n\r]+/g, ''));
			} catch (e) {
				throw 'naff-menu build error: invalid json string [' + menuItems.replace(/[\n\r]+/g, '') + ']';
			}
		}
	});
</script>

<style>
	body { overflow: hidden; margin: 0; padding: 0; }
	naff-page { padding: 10px 10px 10px 235px; position: absolute; height: 100%; width: 100%; overflow: auto; box-sizing: border-box; }
	naff-page[position="left"] { padding: 10px 235px 10px 10px; }
	@media (max-width: 600px) { body { overflow: visible; margin: 0; padding: 40px 0px 0px 0px; } naff-page { padding: 10px; height: auto; overflow: initial; } }
</style>

<!-- LOGIC -->
<script>naff.registerElement({name: 'naff-page'})</script>


</head><body><div hidden="">













</div></body></html>